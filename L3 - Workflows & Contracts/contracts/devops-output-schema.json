{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Deployment Report Schema",
  "type": "object",
  "required": [
    "deployment_summary",
    "infrastructure",
    "services_deployed",
    "monitoring_setup",
    "security_measures",
    "smoke_tests",
    "rollback_plan"
  ],
  "properties": {
    "deployment_summary": {
      "type": "object",
      "required": ["environment", "deployed_at", "status"],
      "properties": {
        "environment": {"type": "string", "enum": ["production", "staging", "dev", "qa"]},
        "deployed_at": {"type": "string", "format": "date-time"},
        "deployment_method": {
          "type": "string",
          "enum": ["blue_green", "canary", "rolling", "direct"]
        },
        "status": {"type": "string", "enum": ["success", "failed", "rolled_back", "partial"]},
        "deployed_by": {"type": "string"},
        "deployment_duration_seconds": {"type": "number"},
        "downtime_seconds": {"type": "number"}
      }
    },
    "infrastructure": {
      "type": "object",
      "required": ["cloud_provider"],
      "properties": {
        "cloud_provider": {
          "type": "string",
          "examples": ["AWS", "GCP", "Azure", "DigitalOcean", "Self-hosted"]
        },
        "region": {"type": "string"},
        "resources_provisioned": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["resource_type", "name"],
            "properties": {
              "resource_type": {"type": "string"},
              "name": {"type": "string"},
              "details": {"type": "string"},
              "cost_estimate_monthly_usd": {"type": "number"}
            }
          }
        },
        "infrastructure_as_code": {
          "type": "object",
          "properties": {
            "tool": {"type": "string", "examples": ["Terraform", "Pulumi", "CloudFormation", "CDK"]},
            "repository": {"type": "string"},
            "version": {"type": "string"}
          }
        }
      }
    },
    "services_deployed": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["service_name", "version", "status"],
        "properties": {
          "service_name": {"type": "string"},
          "version": {"type": "string"},
          "url": {"type": "string", "format": "uri"},
          "health_check_url": {"type": "string", "format": "uri"},
          "status": {"type": "string", "enum": ["healthy", "degraded", "unhealthy", "down"]},
          "replicas": {"type": "number"},
          "resource_allocation": {
            "type": "object",
            "properties": {
              "cpu": {"type": "string"},
              "memory": {"type": "string"},
              "storage": {"type": "string"}
            }
          }
        }
      }
    },
    "database_migrations": {
      "type": "object",
      "properties": {
        "executed": {"type": "boolean"},
        "migration_files": {"type": "array", "items": {"type": "string"}},
        "status": {"type": "string", "enum": ["success", "failed", "skipped"]},
        "rollback_available": {"type": "boolean"},
        "backup_created": {"type": "boolean"}
      }
    },
    "ci_cd_pipeline": {
      "type": "object",
      "properties": {
        "tool": {"type": "string"},
        "pipeline_url": {"type": "string", "format": "uri"},
        "build_number": {"type": "string"},
        "build_duration_seconds": {"type": "number"},
        "automated_tests_passed": {"type": "boolean"}
      }
    },
    "monitoring_setup": {
      "type": "object",
      "required": ["metrics", "logging", "alerting"],
      "properties": {
        "metrics": {
          "type": "object",
          "required": ["enabled"],
          "properties": {
            "enabled": {"type": "boolean"},
            "tool": {"type": "string", "examples": ["Prometheus", "Datadog", "CloudWatch", "Grafana"]},
            "metrics_tracked": {"type": "array", "items": {"type": "string"}},
            "dashboard_url": {"type": "string", "format": "uri"}
          }
        },
        "logging": {
          "type": "object",
          "required": ["enabled"],
          "properties": {
            "enabled": {"type": "boolean"},
            "tool": {"type": "string", "examples": ["Elasticsearch", "CloudWatch", "Datadog", "Splunk"]},
            "log_retention_days": {"type": "number"},
            "log_level": {"type": "string", "enum": ["debug", "info", "warn", "error"]}
          }
        },
        "alerting": {
          "type": "object",
          "required": ["enabled"],
          "properties": {
            "enabled": {"type": "boolean"},
            "tool": {"type": "string", "examples": ["PagerDuty", "OpsGenie", "Slack", "Email"]},
            "alerts_configured": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "condition", "severity"],
                "properties": {
                  "name": {"type": "string"},
                  "condition": {"type": "string"},
                  "severity": {"type": "string", "enum": ["critical", "warning", "info"]},
                  "notification_channel": {"type": "string"}
                }
              }
            }
          }
        },
        "tracing": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "tool": {"type": "string", "examples": ["Jaeger", "Zipkin", "OpenTelemetry", "Datadog APM"]}
          }
        }
      }
    },
    "security_measures": {
      "type": "object",
      "required": ["ssl_enabled", "secrets_management"],
      "properties": {
        "ssl_enabled": {"type": "boolean"},
        "ssl_certificate": {
          "type": "object",
          "properties": {
            "provider": {"type": "string"},
            "expiration_date": {"type": "string", "format": "date"}
          }
        },
        "secrets_management": {
          "type": "string",
          "examples": ["AWS Secrets Manager", "Vault", "Azure Key Vault", "GCP Secret Manager"]
        },
        "firewall_configured": {"type": "boolean"},
        "network_policies": {
          "type": "object",
          "properties": {
            "ingress_rules": {"type": "array", "items": {"type": "string"}},
            "egress_rules": {"type": "array", "items": {"type": "string"}}
          }
        },
        "backups_enabled": {"type": "boolean"},
        "backup_frequency": {"type": "string"},
        "disaster_recovery_plan": {"type": "string"}
      }
    },
    "smoke_tests": {
      "type": "object",
      "required": ["status"],
      "properties": {
        "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
        "tests_run": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["test_name", "status"],
            "properties": {
              "test_name": {"type": "string"},
              "status": {"type": "string", "enum": ["passed", "failed"]},
              "details": {"type": "string"}
            }
          }
        }
      }
    },
    "performance_baseline": {
      "type": "object",
      "properties": {
        "response_time_p95_ms": {"type": "number"},
        "requests_per_second": {"type": "number"},
        "error_rate_percentage": {"type": "number"},
        "uptime_percentage": {"type": "number"}
      }
    },
    "rollback_plan": {
      "type": "string",
      "description": "Detailed plan for how to rollback this deployment if issues arise"
    },
    "known_issues": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["description", "severity"],
        "properties": {
          "description": {"type": "string"},
          "severity": {"type": "string", "enum": ["low", "medium", "high", "critical"]},
          "workaround": {"type": "string"},
          "tracking_ticket": {"type": "string"}
        }
      }
    },
    "next_steps": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Follow-up tasks or improvements needed"
    },
    "documentation": {
      "type": "object",
      "properties": {
        "runbook_url": {"type": "string", "format": "uri"},
        "architecture_diagram_url": {"type": "string", "format": "uri"},
        "deployment_guide_url": {"type": "string", "format": "uri"}
      }
    }
  }
}
