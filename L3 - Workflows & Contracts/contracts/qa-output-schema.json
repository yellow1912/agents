{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "QA Test Report Schema",
  "type": "object",
  "required": [
    "test_summary",
    "functional_tests",
    "non_functional_tests",
    "bugs_found",
    "acceptance_criteria_status",
    "recommendation"
  ],
  "properties": {
    "test_summary": {
      "type": "object",
      "required": ["total_tests_run", "tests_passed", "tests_failed"],
      "properties": {
        "total_tests_run": {"type": "number"},
        "tests_passed": {"type": "number"},
        "tests_failed": {"type": "number"},
        "tests_skipped": {"type": "number"},
        "test_coverage_percentage": {"type": "number"},
        "test_duration_seconds": {"type": "number"}
      }
    },
    "functional_tests": {
      "type": "object",
      "required": ["status", "requirements_validated"],
      "properties": {
        "status": {"type": "string", "enum": ["passed", "failed", "partial"]},
        "requirements_validated": {
          "type": "array",
          "items": {"type": "string"}
        },
        "failed_requirements": {
          "type": "array",
          "items": {"type": "string"}
        },
        "test_cases_executed": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["test_id", "description", "status"],
            "properties": {
              "test_id": {"type": "string"},
              "description": {"type": "string"},
              "status": {"type": "string", "enum": ["passed", "failed", "skipped"]},
              "expected_result": {"type": "string"},
              "actual_result": {"type": "string"}
            }
          }
        }
      }
    },
    "non_functional_tests": {
      "type": "object",
      "properties": {
        "performance": {
          "type": "object",
          "required": ["status"],
          "properties": {
            "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
            "metrics": {
              "type": "object",
              "properties": {
                "avg_response_time_ms": {"type": "number"},
                "p50_response_time_ms": {"type": "number"},
                "p95_response_time_ms": {"type": "number"},
                "p99_response_time_ms": {"type": "number"},
                "requests_per_second": {"type": "number"},
                "concurrent_users_tested": {"type": "number"},
                "error_rate_percentage": {"type": "number"}
              }
            },
            "load_test_results": {
              "type": "object",
              "properties": {
                "peak_load": {"type": "number"},
                "system_stable": {"type": "boolean"},
                "bottlenecks_identified": {"type": "array", "items": {"type": "string"}}
              }
            }
          }
        },
        "security": {
          "type": "object",
          "required": ["status"],
          "properties": {
            "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
            "vulnerabilities_found": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["type", "severity"],
                "properties": {
                  "type": {"type": "string"},
                  "severity": {"type": "string", "enum": ["low", "medium", "high", "critical"]},
                  "description": {"type": "string"},
                  "remediation": {"type": "string"}
                }
              }
            },
            "tests_performed": {
              "type": "array",
              "items": {"type": "string"}
            }
          }
        },
        "accessibility": {
          "type": "object",
          "required": ["status"],
          "properties": {
            "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
            "wcag_level": {"type": "string", "enum": ["A", "AA", "AAA"]},
            "issues_found": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["description", "severity"],
                "properties": {
                  "description": {"type": "string"},
                  "severity": {"type": "string", "enum": ["minor", "moderate", "serious", "critical"]},
                  "wcag_criterion": {"type": "string"},
                  "impact": {"type": "string"}
                }
              }
            },
            "compliance_percentage": {"type": "number"}
          }
        },
        "usability": {
          "type": "object",
          "properties": {
            "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
            "issues_found": {"type": "array", "items": {"type": "string"}},
            "user_flow_completion_rate": {"type": "number"}
          }
        },
        "compatibility": {
          "type": "object",
          "properties": {
            "browsers_tested": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {"type": "string"},
                  "version": {"type": "string"},
                  "status": {"type": "string", "enum": ["passed", "failed"]}
                }
              }
            },
            "devices_tested": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "device": {"type": "string"},
                  "status": {"type": "string", "enum": ["passed", "failed"]}
                }
              }
            }
          }
        }
      }
    },
    "integration_tests": {
      "type": "object",
      "properties": {
        "frontend_backend": {
          "type": "object",
          "properties": {
            "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
            "issues_found": {"type": "array", "items": {"type": "string"}}
          }
        },
        "external_services": {
          "type": "object",
          "properties": {
            "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
            "services_tested": {"type": "array", "items": {"type": "string"}},
            "issues_found": {"type": "array", "items": {"type": "string"}}
          }
        },
        "ai_integrations": {
          "type": "object",
          "properties": {
            "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
            "models_tested": {"type": "array", "items": {"type": "string"}},
            "issues_found": {"type": "array", "items": {"type": "string"}}
          }
        }
      }
    },
    "bugs_found": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["bug_id", "severity", "priority", "description", "status"],
        "properties": {
          "bug_id": {"type": "string"},
          "severity": {"type": "string", "enum": ["critical", "high", "medium", "low"]},
          "priority": {"type": "string", "enum": ["p0", "p1", "p2", "p3"]},
          "description": {"type": "string"},
          "steps_to_reproduce": {"type": "array", "items": {"type": "string"}},
          "expected_behavior": {"type": "string"},
          "actual_behavior": {"type": "string"},
          "status": {"type": "string", "enum": ["open", "in_progress", "fixed", "verified", "wont_fix"]},
          "affected_components": {"type": "array", "items": {"type": "string"}},
          "screenshot_url": {"type": "string"},
          "assigned_to": {"type": "string"}
        }
      }
    },
    "acceptance_criteria_status": {
      "type": "object",
      "required": ["all_criteria_met"],
      "properties": {
        "all_criteria_met": {"type": "boolean"},
        "met_criteria": {"type": "array", "items": {"type": "string"}},
        "unmet_criteria": {"type": "array", "items": {"type": "string"}},
        "criteria_details": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["criterion_id", "description", "status"],
            "properties": {
              "criterion_id": {"type": "string"},
              "description": {"type": "string"},
              "status": {"type": "string", "enum": ["met", "not_met", "partially_met"]},
              "notes": {"type": "string"}
            }
          }
        }
      }
    },
    "regression_tests": {
      "type": "object",
      "properties": {
        "status": {"type": "string", "enum": ["passed", "failed", "not_run"]},
        "regressions_found": {"type": "array", "items": {"type": "string"}},
        "tests_run": {"type": "number"}
      }
    },
    "edge_cases_tested": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["description", "status"],
        "properties": {
          "description": {"type": "string"},
          "status": {"type": "string", "enum": ["passed", "failed"]},
          "notes": {"type": "string"}
        }
      }
    },
    "recommendation": {
      "type": "string",
      "enum": ["approve_for_deployment", "needs_fixes", "major_issues"]
    },
    "deployment_blockers": {
      "type": "array",
      "items": {"type": "string"}
    },
    "notes": {"type": "string"}
  }
}
